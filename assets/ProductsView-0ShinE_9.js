import{_ as x,o as l,c as r,a as t,n,F as p,r as f,t as c,b as w,d as u,e as y,f as k}from"./index-kE_-QtKX.js";const M={data(){return{}},props:["paginationObj"],watch:{paginationObj(){}},methods:{changePage(e){e.target.closest("li").className.includes("active")||this.$emit("emit-selectPage",e.target.textContent)}},created(){},mounted(){}},j={class:"pagination justify-content-center"};function P(e,i,s,b,o,d){return l(),r("nav",null,[t("ul",j,[t("li",{class:n(["page-item",{disabled:!s.paginationObj.has_pre}])},[t("a",{class:n(["page-link",{"text-dark":!s.paginationObj.has_pre}])},"Previous",2)],2),(l(!0),r(p,null,f(s.paginationObj.total_pages,(_,a)=>(l(),r("li",{class:n(["page-item",{active:s.paginationObj.current_page===a+1}]),key:"key"+a},[t("a",{class:n(["page-link",{"text-dark":s.paginationObj.current_page===a+1}]),onClick:i[0]||(i[0]=(...h)=>d.changePage&&d.changePage(...h))},c(a+1),3)],2))),128)),t("li",{class:n(["page-item",{disabled:!s.paginationObj.has_next}])},[t("a",{class:n(["page-link",{"text-dark":!s.paginationObj.has_next}])},"Next",2)],2)])])}const S=x(M,[["render",P]]),g="https://ec-course-api.hexschool.io/",m="bftsai",v={data(){return{products:[],paginationObj:{},itemSelect:{},productsNum:0}},components:{pagination:S},props:["defaultTheme"],watch:{defaultTheme(){console.log(this.defaultTheme)}},methods:{textDanger(e){if(!e&&this.defaultTheme==="light")return!0},textLight(e){if(!e&&this.defaultTheme==="dark")return!0},async getAllProducts(){try{const e=(await this.axios.get(`${g}v2/api/${m}/admin/products/all`)).data.products;this.productsNum=Object.keys(e)}catch(e){console.log(e)}},async getProducts(e){try{this.product=[],this.$emit("emit-toggleLoading");const i=(await this.axios.get(`${g}v2/api/${m}/admin/products?page=${e}`)).data;this.products=i.products,this.paginationObj=i.pagination,this.$emit("emit-toggleLoading");const s={icon:"success",title:"已取得產品資料",timer:1500};this.$swal(s)}catch(i){console.log(i),this.$emit("emit-toggleLoading");const s={icon:"error",title:i.response.data.message};this.$swal(s)}},checkProduct(e){this.itemSelect=JSON.parse(JSON.stringify(e))},async postProduct(){try{const e={data:{title:"香蕉派",category:"蛋糕",origin_price:200,price:150,unit:"個",description:"呈現經典的美味及口感。",content:"尺寸：8寸",is_enabled:7,imageUrl:"https://images.unsplash.com/photo-1484723091739-30a097e8f929?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8YmFuYW5hJTIwcGllfGVufDB8fDB8fHww",imagesUrl:["https://images.unsplash.com/photo-1616953343564-dcf52de3262c?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D","https://images.unsplash.com/photo-1517777596324-5df4025800f2?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D","https://images.unsplash.com/photo-1636819232432-77f353ba39f8?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTZ8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D"]}},i=await this.axios.post(`${g}v2/api/${m}/admin/product`,e);console.log(i)}catch(e){console.log(e)}},async checkLogin(){try{this.$emit("emit-toggleLoading");const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common.Authorization=e;const i=(await this.axios.post(`${g}v2/api/user/check`)).data;i.success&&(this.$emit("emit-toggleLogin",i.success),this.getProducts(1)),this.$emit("emit-toggleLoading")}catch(e){this.$emit("emit-toggleLogin",e.response.data.success);const i={icon:"error",title:e.response.data.message,timer:1500};this.$swal(i),this.$emit("emit-toggleLoading"),e.response.data.success||this.$router.push("login")}},selectPage(e){this.getProducts(e)}},created(){this.$emit("emit-login"),this.checkLogin(),this.getAllProducts()}},T={class:"container"},D={class:"row"},O={class:"col-lg-6"},H=t("h1",null,"Products List",-1),L={class:"table table-hover"},B=t("thead",null,[t("tr",{class:"text-center"},[t("th",{scope:"col"},"產品名稱"),t("th",{scope:"col"},"原價"),t("th",{scope:"col"},"售價"),t("th",{scope:"col"},"是否啟用"),t("th",{scope:"col"},"查看細節")])],-1),A=["onClick"],C={key:0,class:"col-lg-6"},F=t("h2",null,"Product",-1),N=["src","alt"],Y={class:"card-body"},U={class:"card-title"},Z={class:"card-text"},J={class:"card-text"},z={class:"card-text"},V={class:"d-flex flex-wrap mb-3"},$=["src","alt"];function G(e,i,s,b,o,d){const _=k("pagination");return l(),r("div",T,[t("div",D,[t("div",O,[H,t("table",L,[B,t("tbody",null,[(l(!0),r(p,null,f(o.products,a=>(l(),r("tr",{key:a.title,class:"text-center"},[t("td",null,c(a.title),1),t("td",null,c(a.origin_price),1),t("td",null,c(a.price),1),t("td",{class:n({"text-danger":d.textDanger(a.is_enabled),"text-light":d.textLight(a.is_enabled)})},c(a.is_enabled?"啟用":"未啟用"),3),t("td",null,[t("button",{type:"button",class:n(["btn w-100",{"btn-secondary":s.defaultTheme==="light","btn-outline-primary":s.defaultTheme==="dark"}]),onClick:h=>d.checkProduct(a)},"查看細節",10,A)])]))),128))])]),w(_,{"pagination-obj":o.paginationObj,onEmitSelectPage:d.selectPage},null,8,["pagination-obj","onEmitSelectPage"])]),o.itemSelect.id?(l(),r("div",C,[F,t("div",{class:n(["card mb-3",{"border-primary":s.defaultTheme==="dark"}])},[t("img",{src:o.itemSelect.imageUrl,class:"card-img-top object-fit-contain",alt:o.itemSelect.title,height:"400"},null,8,N),t("div",Y,[t("h5",U,[u(c(o.itemSelect.title),1),t("span",{class:n(["badge ms-3",{" text-bg-secondary":s.defaultTheme==="light"," text-bg-primary":s.defaultTheme==="dark"}])},c(o.itemSelect.category),3)]),t("p",Z,"商品內容："+c(o.itemSelect.content),1),t("p",J,"商品描述："+c(o.itemSelect.description),1),t("p",z,[u(c(o.itemSelect.price)+" ",1),t("span",{class:n(["line-through",{"text-light":s.defaultTheme==="dark"}])},c(o.itemSelect.origin_price),3),u("元 / 個")])])],2),t("div",V,[(l(!0),r(p,null,f(o.itemSelect.imagesUrl,(a,h)=>(l(),r("img",{src:a,alt:"小圖"+h,key:"小圖"+h,height:"200",class:"me-3 mb-3"},null,8,$))),128))])])):y("",!0)])])}const q=x(v,[["render",G]]);export{q as default};
